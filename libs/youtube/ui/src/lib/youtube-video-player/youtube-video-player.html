<section class="yt-player" aria-label="YouTube video player" (pointermove)="onPointerMove()">
  <div #playerContainer class="yt-player__frame" role="group" aria-label="Video area"></div>

  <div
    class="yt-player__controls"
    role="group"
    aria-label="Player controls"
    [class.hidden]="!controlsVisible()"
    tabindex="0"
    (focus)="onControlsFocus()"
    (blur)="onControlsBlur()"
  >
    <button
      type="button"
      class="yt-player__btn"
      [disabled]="!player.isReady()"
      [attr.aria-pressed]="player.isPlaying() ? 'true' : 'false'"
      [attr.aria-label]="player.isPlaying() ? 'Pause' : 'Play'"
      (click)="player.isPlaying() ? player.pause() : player.play()"
    >
      @if (player.isPlaying()) {
        <!-- Pause icon -->
        <svg class="yt-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <rect x="6" y="4" width="4" height="16"></rect>
          <rect x="14" y="4" width="4" height="16"></rect>
        </svg>
        <span class="visually-hidden">Pause</span>
      } @else {
        <!-- Play icon -->
        <svg class="yt-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <polygon points="8,5 19,12 8,19"></polygon>
        </svg>
        <span class="visually-hidden">Play</span>
      }
    </button>

    <label class="yt-player__time" [attr.for]="'yt-progress'">
      <span aria-label="Current time">{{ player.currentTime() | number:'1.0-0' }}s</span>
      /
      <span aria-label="Duration">{{ player.duration() | number:'1.0-0' }}s</span>
    </label>

    <input
      id="yt-progress"
      class="yt-player__progress"
      type="range"
      [min]="0"
      [max]="player.duration()"
      [step]="0.1"
      [value]="player.currentTime()"
      [disabled]="!player.isReady()"
      (input)="onSeekChange($event)"
      aria-label="Seek"
    />

    <div class="yt-player__volume" role="group" aria-label="Volume controls">
      <button
        type="button"
        class="yt-player__btn"
        [disabled]="!player.isReady()"
        [attr.aria-pressed]="player.isMuted() ? 'true' : 'false'"
        [attr.aria-label]="player.isMuted() ? 'Unmute' : 'Mute'"
        (click)="player.toggleMute()"
      >
        @if (player.isMuted() || player.volume() === 0) {
          <!-- Muted icon -->
          <svg class="yt-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path
              d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"></path>
          </svg>
          <span class="visually-hidden">Unmute</span>
        } @else if (player.volume() < 50) {
          <!-- Low volume icon -->
          <svg class="yt-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M18.5 12c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM5 9v6h4l5 5V4L9 9H5z"></path>
          </svg>
          <span class="visually-hidden">Mute</span>
        } @else {
          <!-- High volume icon -->
          <svg class="yt-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path
              d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"></path>
          </svg>
          <span class="visually-hidden">Mute</span>
        }
      </button>

      <input
        class="yt-player__volume-slider"
        type="range"
        [min]="0"
        [max]="100"
        [step]="1"
        [value]="player.isMuted() ? 0 : player.volume()"
        [disabled]="!player.isReady()"
        (input)="onVolumeChange($event)"
        aria-label="Volume"
      />
    </div>

    <button
      type="button"
      class="yt-player__btn"
      aria-label="Toggle fullscreen"
      (click)="toggleFullscreen()"
    >
      @if (isFullscreen()) {
        <!-- Exit fullscreen icon -->
        <svg class="yt-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M14 10V4h6v2h-4v4h-2zM4 10V4h6v2H6v4H4zm10 10v-6h2v4h4v2h-6zM4 20v-6h2v4h4v2H4z"></path>
        </svg>
        <span class="visually-hidden">Exit Fullscreen</span>
      } @else {
        <!-- Enter fullscreen icon -->
        <svg class="yt-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M14 4h6v6h-2V6h-4V4zM4 4h6v2H6v4H4V4zm16 16h-6v-2h4v-4h2v6zM10 20H4v-6h2v4h4v2z"></path>
        </svg>
        <span class="visually-hidden">Fullscreen</span>
      }
    </button>

    @if (player.watchUrl()) {
      <a
        class="yt-player__link"
        [href]="player.watchUrl()!"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="Open video on YouTube"
      >
        <!-- External link icon -->
        <svg class="yt-icon" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
          <path d="M14 3h7v7h-2V6.41l-9.29 9.3-1.42-1.42L17.59 5H14V3z"></path>
          <path d="M5 5h6v2H7v10h10v-4h2v6H5V5z"></path>
        </svg>
        <span class="visually-hidden">Open on YouTube</span>
      </a>
    }
  </div>
</section>
